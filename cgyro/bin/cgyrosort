#!/usr/bin/env python

import os,re,sys
import numpy as np
import matplotlib.pyplot as plt
from matplotlib import rc

rc('text',usetex=True)
rc('font',size=16)

def mygrep(f):
   with open(f,'r') as file:
      for line in file:
         if re.search('KY', line):
            ky = line.strip().split('=')[1]
   return ky

r = './'

dirs = os.listdir(r)
k = []
d = []
for d0 in dirs:
   if os.path.isdir(d0):
      d.append(d0)
      ky = mygrep(d0+'/input.cgyro')
      k.append(float(ky))

n = len(k)
i = np.argsort(k)

w1 = [] ; g1 = [] ; k1 = []
w2 = [] ; g2 = [] ; k2 = []

indx = np.genfromtxt('indx',dtype=int)
   
for j,i0 in enumerate(i):
   data = np.genfromtxt(d[i0]+'/out.cgyro.dmd',comments='#')
   z = data.flatten()
   n = len(z)//3
   i1 = indx[j,0]
   i2 = indx[j,1]
   if i1 == 1:
      g1.append(z[0]) ; w1.append(z[1]) ; k1.append(k[i0])
   if i1 == 2:
      g2.append(z[0]) ; w2.append(z[1]) ; k2.append(k[i0])
   if i2 == 1:
      g1.append(z[3]) ; w1.append(z[4]) ; k1.append(k[i0])
   if i2 == 2:
      g2.append(z[3]) ; w2.append(z[4]) ; k2.append(k[i0])

f = open('mode1','w')
for i in range(len(k1)):
   data = (k1[i],w1[i],g1[i])
   str1 = '{:+.5f}  {:+.5f}  {:.5f} \n'.format(*data)
   f.write(str1)
f.close()

f = open('mode2','w')
for i in range(len(k2)):
   data = (k2[i],w2[i],g2[i])
   str1 = '{:.5f}  {:+.5f}  {:.5f} \n'.format(*data)
   f.write(str1)
f.close()
