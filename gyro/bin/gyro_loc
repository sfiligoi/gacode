#!/usr/bin/env python

#-------------------------------------------------
# SCRIPT:
#  gyro_loc
#
# FUNCTION:
#  Extract local parameters from run.out
#
# REVISIONS:
# 28 March 2006: jc
#  Added documentation.
#--------------------------------------------------

import sys
import os
import string

n=len(sys.argv)

if n == 1:
    print "Usage: gyro_loc [-p] [-a]"
    print 
    print " -p :  print to screen"
    print " -a :  create new INPUT.append with local data"
    print
    print "Note: must be run in a sim directory containing"
    print "      a run.out file."
    sys.exit(0)	

try:
    file=open('run.out','r')
except IOError:
    print 'run.out is missing.  Run \'gyro -t\' first.'
    sys.exit(0)

append=0

if n > 1:
    if sys.argv[1] == '-a':
        append=1
        os.system('cp INPUT INPUT.append')
        os.system('echo " " >> INPUT.append')
        os.system('echo "#Data generated by gyro_loc" >> INPUT.append')

for line in file.readlines():

    line = string.strip(line)

    # Skip blank lines

    if len(line) > 0:
        if (line[0] == '.'):
            data = string.splitfields(line,':')
            tag=string.strip(data[0])
            num=string.strip(data[1])
            text=tag[1:len(tag)]+'='+num
            if append == 0:
                print text
            else:
                os.system('echo '+text+' >> INPUT.append')
        if (line[0] == '#'):
            if append == 0:
                print line
            else:
                os.system('echo '+line+' >> INPUT.append')
                
            
            
